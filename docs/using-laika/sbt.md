
Using the sbt Plugin
====================


Laika Tasks for sbt
-------------------

Laika currently supports the following sbt tasks:

* `laikaSite`
  Processes all files from the source directories and renders the 
  result to `target/docs/site` (unless overridden). By default only
  HTML output gets rendered by this task. You can add API documentation
  for a Scala project with the `includeAPI` setting and a PDF file rendered
  from the same markup sources with the `includePDF` setting.

* `laikaPackageSite`  
  Packages the site into a zip file inside the `target/docs`
  directory. Depends on the `laikaSite` task.

* `laika:clean`  
  Deletes the contents of Laika's target directory only. Alternatively
  you can also run the global `clean` task which will delete content generated by
  Laika together with the target directories of other tasks.
  
* `laikaGenerate`
  Generates the output format specified as arguments to this task.
  For example `laikaGenerate html epub pdf` generates an HTML site as well
  as an EPUB and a PDF file from the parsed source markup. The markup will only
  get parsed once, therefore this task is very efficient for producing
  multiple output formats. The formats supported as arguments to this
  task are `html`, `epub`, `pdf`, `xslfo` and `ast`. If you only want
  to generate one output format there are shortcut tasks for each of them:
  `laikaHTML`, `laikaEPUB`, `laikaPDF`, `laikaXSLFO`, `laikaAST`.
  
The default settings for these tasks should be sufficient for many use cases.
The following sections show how you can override the defaults. 

You can also get a formatted summary of all settings and extensions by running
`show laikaDescribe`.



Basic Settings
--------------

The following list shows the names, types and default values of the basic settings:


* `sourceDirectories in Laika` - `Seq[File]` - default `Seq("src/docs")`  
  Specifies one or more
  source directories to process. All specified directories can contain any of the supported
  file types and will get merged into a tree with a single root.

* `target in Laika` - `File` - default `target/docs`  
  Specifies the directory where the plugin
  should generate the site. This key also has separate values scoped to the individual tasks:
  `target in laikaSite` (default `target/docs/site`), `target in laikaCopyAPI` (default `target/docs/site/api`)
  and `target in laikaPackageSite` (default `target/docs`). 

* `excludeFilter in Laika` - `FileFilter` - default `HiddenFileFilter`  
  Specifies files to exclude from processing.
  Note that Laika ignores any `includeFilter` you set, as the tool needs more than a simple yes/no
  decision for deciding how to process files. If a simple exclusion filter is not sufficient, you can
  specify a `laikaDocTypeMatcher` as explained in [Settings for Customization Hooks].

* `laikaExtensions` - `Seq[ExtensionBundle]` - default `Nil`
  The main extension hook that allows to add one or more `ExtensionBundle` instances for adding
  directives, parser extensions, rewrite rules or custom renderers. See the sections below for examples
  for custom renderers and rewrite rules.

* `laikaConfig` - `LaikaConfig`
  allows to specify additional flags and settings through instances of `LaikaConfig`:
    * `encoding`: specifies the character encoding (default `UTF-8`)
    * `strict`: switches off all extensions and only uses features defined in the spec of the markup languages (default `false`)
    * `rawContent`: allows to include raw content like HTML embedded in text markup (default `false`)
    * `renderMessageLevel`: the minimum level required for an invalid node to be rendered to the output (default `Warning`)
    * `logMessageLevel`: the minimum level required for an invalid node to be logged to the console (default `Warning`)
    * `parallel`: whether parsing and rendering should happen in parallel (default `true`)

* `laikaIncludeAPI` - `Boolean` - default `false`  
  Indicates whether generated scaladoc APIs should be included when running the `laikaSite` task. 
  The folder for the API can be set with `target in copyAPI` (default `target/docs/site/api`).

* `laikaIncludeEPUB` - `Boolean` - default `false`
  Indicates whether a generated EPUB file should be included when running the `laikaSite` task.
  The file name for the EPUB can be set with `artifact in laikaEPUB` (default `target/docs/site/<noduleName>-<version>.epub`).
    
* `laikaIncludePDF` - `Boolean` - default `false`
  Indicates whether a generated PDF file should be included when running the `laikaSite` task.
  The file name for the PDF can be set with `artifact in laikaPDF` (default `target/docs/site/<noduleName>-<version>.pdf`).


Using Laika for GitHub Pages
----------------------------

If you want to generate the site and push it up to the gh-pages branch of your GitHub repository
in one go, you can combine Laika and the sbt-ghpages plugin.

Add the sbt-ghpages plugin to `project/plugins.sbt`:

```scala
resolvers += "jgit-repo" at "http://download.eclipse.org/jgit/maven"

addSbtPlugin("com.typesafe.sbt" % "sbt-ghpages" % "0.5.2")
```

Configure the plugins in `build.sbt`:

```scala
enablePlugins(LaikaPluging, GhpagesPlugin)

git.remoteRepo := "git@github.com:{your username}/{your project}.git"

git.gitCurrentBranch := "master"

mappings in synchLocal := (mappings in laikaSite).value
```

It is the last line that connects the two plugins, but there is no need
to understand how that line works.

Finally run the task `ghpages-push-site`. This will also trigger the 
Laika transformation if the site output is not up-to-date.
