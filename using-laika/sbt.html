<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <title>Laika</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Customizable and extensible toolkit for transforming lightweight markup languages to various types of output formats, written in Scala" />
    <meta name="keywords" content="scala, text, markup, markdown, restructuredtext, parser, transformer, html, template engine, site generation, open-source" />

    <link href='http://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@1.207/distr/fira_code.css">
    <link href="../css/bootstrap.css" rel="stylesheet">
    <link href="../css/docs.css" rel="stylesheet">

  </head>

  <body data-spy="scroll" data-target=".toc" data-offset="200">


  <div class="container">

    <!-- Docs nav
    ================================================== -->
    <div class="row">
      <div class="span4 toc" >
        
        <ul class="nav nav-list affix">
          <div class="nav-top"><img src="../img/laika-top.png"/></div>
          
          
          <li class="nav-header">Introduction</li>
          <li><a href="../introduction/intro.html">Overview</a></li>
          <li><a href="../introduction/architecture.html">Architecture</a></li>
          <li class="nav-header">Using Laika</li>
          <li class="active"><a href="#">Using the sbt Plugin</a></li>
          <li><a href="embedded.html">Using the Library API</a></li>
          <li><a href="markup.html">Supported Markup</a></li>
          <li><a href="output.html">Supported Output Formats</a></li>
          <li><a href="structure.html">Document Structure</a></li>
          <li><a href="templates.html">Templates</a></li>
          <li><a href="syntax.html">Syntax Highlighting</a></li>
          <li class="nav-header">Customizing Laika</li>
          <li><a href="../customizing-laika/customize-rendering.html">Customizing Renderers</a></li>
          <li><a href="../customizing-laika/tree-rewriting.html">Document Tree Rewriting</a></li>
          <li><a href="../customizing-laika/parsing-rendering.html">Separate Parsing and Rendering</a></li>
          <li class="nav-header">Extending Laika</li>
          <li><a href="../extending-laika/directive.html">Directives</a></li>
          <li><a href="../extending-laika/parser.html">Parsers</a></li>
          <li><a href="../extending-laika/renderer.html">Renderers</a></li>
          <li><a href="../extending-laika/extending-rst.html">Extending reStructuredText</a></li>
          
          <li class="nav-header">Project Links</li>
          <li><a href="http://github.com/planet42/Laika">Source Code</a></li>
          <li><a href="../api/laika/api/">API Documentation</a></li>
          <li><a href="http://github.com/planet42/Laika/issues">Issue Tracker</a></li>
          <li><a href="http://planet42.org/">Transformer Web Tool</a></li>
          <li class="follow"><a href="https://twitter.com/_planet42" class="twitter-follow-button" data-show-count="false" data-show-screen-name="false" data-dnt="true">Follow @_planet42</a>
          <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script></li>
          
          <div class="nav-bottom"><img src="../img/laika-bottom.png" border="1"/></div>
        </ul>
        
      </div>
      
      <div class="span8" id="top">

        <div class="page-header">
        <h1 id="using-the-sbt-plugin" class="title">Using the sbt Plugin</h1>
        </div>
        <p>The core of the Laika toolkit does not depend on sbt in any way, and therefore comes with a plugin
        that provides the glue necessary to expose Laika&#39;s feature set as sbt tasks and settings.</p>
        <p>This chapter only covers the topics which are specific to using Laika with sbt, while most other
        parts of the manual apply to both embedded use and sbt plugin.</p>
        
        <h2 id="adding-the-plugin-to-the-build" class="section">Adding the Plugin to the Build</h2>
        <p>Laika&#39;s sbt plugin requires sbt 1.x.</p>
        <p>If you still need to use sbt 0.13.x, you can use Laika 0.7.0 which was the last release
        supporting that sbt version.</p>
        <p>First add the plugin to <code>project/plugins.sbt</code>:</p>
        <pre><code class="nohighlight"><span class="identifier">addSbtPlugin</span><span>(</span><span class="string-literal">&quot;org.planet42&quot;</span><span> % </span><span class="string-literal">&quot;laika-sbt&quot;</span><span> % </span><span class="string-literal">&quot;0.14.0&quot;</span><span>)</span></code></pre>
        <p>If you want to install it globally, add the line above to
        <code>~/.sbt/1.0/plugins/build.sbt</code> instead.</p>
        <p>Then enable the plugin in your project&#39;s <code>build.sbt</code>:</p>
        <pre><code class="nohighlight"><span class="identifier">enablePlugins</span><span>(</span><span class="type-name">LaikaPlugin</span><span>)</span></code></pre>
        <p>You can now add content to the directory <code>src/docs</code> inside your project 
        and run <code>laikaSite</code> from within sbt to generate the site in 
        <code>target/docs/site</code>. See the following sections for details.</p>
        
        <h2 id="editing-content" class="section">Editing Content</h2>
        <p>Laika expects the site content to be organized in a directory. By default this is
        <code>src/docs</code>. In contrast to several similar tools content in Laika is hierarchical.
        Subdirectories can contain markup files, too, and the hierarchy can get
        visualized in a table of contents. Furthermore you can also specify additional
        directories to be merged into the main directory, which allows to keep reusable
        templates and styles (other tools would call it &quot;themes&quot;) in a separate place.</p>
        <p>The directories can contain different types of files:</p>
        <ul>
          <li>
            <p>All of the supported text markup formats (currently this is Markdown and reStructuredText).
            The default parser of the plugin allows to use both formats in the same document
            tree (including cross linking between the two formats) and recognizes them by the
            file suffix (<code>.md</code> or <code>.markdown</code> for Markdown and <code>.rst</code> for reStructuredText). </p>
          </li>
          <li>
            <p>A configuration file <code>directory.conf</code> which allows to specify the document order
            for navigation, the directory title, autonumbering options and other settings.</p>
          </li>
          <li>
            <p>A template file <code>default.template.&lt;format&gt;</code> that gets applied to all markup files in 
            this directory (and its subdirectories unless overridden). The suffix may be any
            output format in Laika that supports templating, currently this is <code>.html</code> for HTML,
            <code>.epub.xhtml</code> for EPUB and <code>.fo</code> for PDF or XSL-FO output. A very basic HTML template may look 
            like this:</p>
          </li>
        </ul>
        <pre><code class="nohighlight"><span class="tag-punctuation">&lt;</span><span class="tag-name">html</span><span class="tag-punctuation">&gt;</span><span>
  </span><span class="tag-punctuation">&lt;</span><span class="tag-name">head</span><span class="tag-punctuation">&gt;</span><span>
    </span><span class="tag-punctuation">&lt;</span><span class="tag-name">title</span><span class="tag-punctuation">&gt;</span><span class="substitution">${document.title}</span><span class="tag-punctuation">&lt;/</span><span class="tag-name">title</span><span class="tag-punctuation">&gt;</span><span>
  </span><span class="tag-punctuation">&lt;/</span><span class="tag-name">head</span><span class="tag-punctuation">&gt;</span><span>
  </span><span class="tag-punctuation">&lt;</span><span class="tag-name">body</span><span class="tag-punctuation">&gt;</span><span>
    </span><span class="tag-punctuation">&lt;</span><span class="tag-name">div</span><span class="tag-punctuation"> </span><span class="attribute-name">class</span><span class="tag-punctuation">=</span><span class="string-literal">&quot;content&quot;</span><span class="tag-punctuation">&gt;</span><span>
      </span><span class="substitution">${document.content}</span><span>
    </span><span class="tag-punctuation">&lt;/</span><span class="tag-name">div</span><span class="tag-punctuation">&gt;</span><span>
  </span><span class="tag-punctuation">&lt;/</span><span class="tag-name">body</span><span class="tag-punctuation">&gt;</span><span>
</span><span class="tag-punctuation">&lt;/</span><span class="tag-name">html</span><span class="tag-punctuation">&gt;</span></code></pre>
        <p>The two placeholders enclosed in double curly braces will be replaced with the
          title and content of the parsed markup document.</p>
        <ul>
          <li>Other static files that simply get copied to the target directory.</li>
        </ul>
        <p>For more details on the template engine, see the chapter <a href="templates.html#templates">Templates</a>.</p>
        <p>For features like titles, sections, cross-linking, auto-numbering, 
        document order and tables of content, see the chapter <a href="structure.html#document-structure">Document Structure</a>.</p>
        <p>For details about Markdown and reStructuredText see the chapter
        <a href="markup.html#supported-markup">Supported Markup</a>.</p>
        <p>For details about rendering see the chapter <a href="output.html#supported-output-formats">Supported Output Formats</a>.</p>
        
        <h2 id="laika-tasks-for-sbt" class="section">Laika Tasks for sbt</h2>
        <p>Laika currently supports the following sbt tasks:</p>
        <ul>
          <li>
            <p><code>laikaSite</code>
            Processes all files from the source directories and renders the 
            result to <code>target/docs/site</code> (unless overridden). By default only
            HTML output gets rendered by this task. You can add API documentation
            for a Scala project with the <code>includeAPI</code> setting and a PDF file rendered
            from the same markup sources with the <code>includePDF</code> setting.</p>
          </li>
          <li>
            <p><code>laikaPackageSite</code><br>
            Packages the site into a zip file inside the <code>target/docs</code>
            directory. Depends on the <code>laikaSite</code> task.</p>
          </li>
          <li>
            <p><code>laika:clean</code><br>
            Deletes the contents of Laika&#39;s target directory only. Alternatively
            you can also run the global <code>clean</code> task which will delete content generated by
            Laika together with the target directories of other tasks.</p>
          </li>
          <li>
            <p><code>laikaGenerate</code>
            Generates the output format specified as arguments to this task.
            For example <code>laikaGenerate html epub pdf</code> generates an HTML site as well
            as an EPUB and a PDF file from the parsed source markup. The markup will only
            get parsed once, therefore this task is very efficient for producing
            multiple output formats. The formats supported as arguments to this
            task are <code>html</code>, <code>epub</code>, <code>pdf</code>, <code>xslfo</code> and <code>ast</code>. If you only want
            to generate one output format there are shortcut tasks for each of them:
            <code>laikaHTML</code>, <code>laikaEPUB</code>, <code>laikaPDF</code>, <code>laikaXSLFO</code>, <code>laikaAST</code>.</p>
          </li>
        </ul>
        <p>The default settings for these tasks should be sufficient for many use cases.
        The following sections show how you can override the defaults. </p>
        <p>You can also get a formatted summary of all settings and extensions by running
        <code>show laikaDescribe</code>.</p>
        
        <h2 id="basic-settings" class="section">Basic Settings</h2>
        <p>The following list shows the names, types and default values of the basic settings:</p>
        <ul>
          <li>
            <p><code>sourceDirectories in Laika</code> - <code>Seq[File]</code> - default <code>Seq(&quot;src/docs&quot;)</code><br>
            Specifies one or more
            source directories to process. All specified directories can contain any of the supported
            file types and will get merged into a tree with a single root.</p>
          </li>
          <li>
            <p><code>target in Laika</code> - <code>File</code> - default <code>target/docs</code><br>
            Specifies the directory where the plugin
            should generate the site. This key also has separate values scoped to the individual tasks:
            <code>target in laikaSite</code> (default <code>target/docs/site</code>), <code>target in laikaCopyAPI</code> (default <code>target/docs/site/api</code>)
            and <code>target in laikaPackageSite</code> (default <code>target/docs</code>). </p>
          </li>
          <li>
            <p><code>excludeFilter in Laika</code> - <code>FileFilter</code> - default <code>HiddenFileFilter</code><br>
            Specifies files to exclude from processing.
            Note that Laika ignores any <code>includeFilter</code> you set, as the tool needs more than a simple yes/no
            decision for deciding how to process files. If a simple exclusion filter is not sufficient, you can
            specify a <code>laikaDocTypeMatcher</code> as explained in <a href="#settings-for-customization-hooks">Settings for Customization Hooks</a>.</p>
          </li>
          <li>
            <p><code>laikaExtensions</code> - <code>Seq[ExtensionBundle]</code> - default <code>Nil</code>
            The main extension hook that allows to add one or more <code>ExtensionBundle</code> instances for adding
            directives, parser extensions, rewrite rules or custom renderers. See the sections below for examples
            for custom renderers and rewrite rules.</p>
          </li>
          <li>
            <p><code>laikaConfig</code> - <code>LaikaConfig</code>
            allows to specify additional flags and settings through instances of <code>LaikaConfig</code>:</p>
            <ul>
              <li><code>encoding</code>: specifies the character encoding (default <code>UTF-8</code>)</li>
              <li><code>strict</code>: switches off all extensions and only uses features defined in the spec of the markup languages (default <code>false</code>)</li>
              <li><code>rawContent</code>: allows to include raw content like HTML embedded in text markup (default <code>false</code>)</li>
              <li><code>renderMessageLevel</code>: the minimum level required for an invalid node to be rendered to the output (default <code>Warning</code>)</li>
              <li><code>logMessageLevel</code>: the minimum level required for an invalid node to be logged to the console (default <code>Warning</code>)</li>
              <li><code>parallel</code>: whether parsing and rendering should happen in parallel (default <code>true</code>)</li>
            </ul>
          </li>
          <li>
            <p><code>laikaIncludeAPI</code> - <code>Boolean</code> - default <code>false</code><br>
            Indicates whether generated scaladoc APIs should be included when running the <code>laikaSite</code> task. 
            The folder for the API can be set with <code>target in copyAPI</code> (default <code>target/docs/site/api</code>).</p>
          </li>
          <li>
            <p><code>laikaIncludeEPUB</code> - <code>Boolean</code> - default <code>false</code>
            Indicates whether a generated EPUB file should be included when running the <code>laikaSite</code> task.
            The file name for the EPUB can be set with <code>artifact in laikaEPUB</code> (default <code>target/docs/site/&lt;noduleName&gt;-&lt;version&gt;.epub</code>).</p>
          </li>
          <li>
            <p><code>laikaIncludePDF</code> - <code>Boolean</code> - default <code>false</code>
            Indicates whether a generated PDF file should be included when running the <code>laikaSite</code> task.
            The file name for the PDF can be set with <code>artifact in laikaPDF</code> (default <code>target/docs/site/&lt;noduleName&gt;-&lt;version&gt;.pdf</code>).</p>
          </li>
        </ul>
        
        <h2 id="settings-for-customization-hooks" class="section">Settings for Customization Hooks</h2>
        <p>Laika allows to easily add custom logic to the processing of documents. When all you need to
        adjust is the processing of one or more particular nodes types, a simple partial function allows
        to do that while still benefiting from the defaults for all other node types.</p>
        <p>When working with the document tree (the internal AST representing the document structure),
        it is most comfortable to add the following import to the build:</p>
        <pre><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">laika</span><span>.</span><span class="identifier">ast</span><span>.</span><span class="identifier">_</span></code></pre>
        
        <h3 id="custom-renderers" class="section">Custom Renderers</h3>
        <p>A custom renderer allows to override the generated output for one or more specific node
        types, while falling back to the default renderers for all other node types.</p>
        <p>The <code>laikaHtmlRenderer</code> shortcut allows to add a custom HTML renderer to the <code>laikaExtensions</code> setting
        and expects a function of type <code>PartialFunction[(HTMLFormatter, Element), String]</code>. </p>
        <p><code>HTMLFormatter</code> provides the API for rendering tags, adds the current indentation level after
        line breaks and knows how to render child elements. </p>
        <p><code>Element</code> is the base trait for all nodes in a document tree. 
        For all elements where this partial function is not defined, Laika will use the default renderers for all node types. </p>
        <p>The following simple example shows how you can add a style to the renderer for
        the <code>&lt;em&gt;</code> tag:</p>
        <pre><code class="nohighlight"><span class="identifier">laikaExtensions</span><span> += </span><span class="identifier">laikaHtmlRenderer</span><span> {
  </span><span class="keyword">case</span><span> (</span><span class="identifier">fmt</span><span>, </span><span class="type-name">Emphasized</span><span>(</span><span class="identifier">content</span><span>, </span><span class="identifier">opt</span><span>)) =&gt; 
    </span><span class="identifier">fmt</span><span>.</span><span class="identifier">element</span><span>(</span><span class="string-literal">&quot;em&quot;</span><span>, </span><span class="identifier">opt</span><span>, </span><span class="identifier">content</span><span>, </span><span class="string-literal">&quot;class&quot;</span><span> -&gt; </span><span class="string-literal">&quot;big&quot;</span><span>) 
}</span></code></pre>
        <p>For more details see the chapter <a href="../customizing-laika/customize-rendering.html#customizing-renderers">Customizing Renderers</a>.</p>
        <p>Similarly the <code>laikaFoRenderer</code> shortcut can be used to add a custom <code>XSL-FO</code> renderer 
        of type <code>PartialFunction[(FOFormatter, Element), String]</code>. <code>XSL-FO</code> is an interim format for PDF output,
        so this option would also allow to change the appearance of PDF documents.</p>
        <p>For EPUB the <code>laikaEpubRenderer</code> can be used to add a custom XHMTL renderer of type
        <code>PartialFunction[(HTMLFormatter, Element), String]</code>. </p>
        
        <h3 id="custom-rewrite-rules" class="section">Custom Rewrite Rules</h3>
        <p>When customizing renderers you have to repeat the step for each output format like HTML, EPUB or PDF. 
        A rewrite rule lets you express a transformation
        of a node inside the document tree before rendering, so it would have an effect on all output formats.</p>
        <p>A rewrite rule is a function of type <code>PartialFunction[T, RewriteAction[T]]</code>.
        If the function is not defined for a particular element or the result is <code>Retain</code> the old element is kept in the tree.
        If it returns <code>Replace(Element)</code> this element replaces the old one.
        If the function returns <code>Remove</code> the old element is removed from the tree.
        The type parameter <code>T</code> is either <code>Block</code>, <code>Span</code> or <code>TemplateSpan</code>, depending on the kind of AST element you
        want to rewrite.</p>
        <p>The following (somewhat contrived, but simple) example shows how to turn each <code>Emphasized</code> node
        into a <code>Strong</code> node:</p>
        <pre><code class="nohighlight"><span class="identifier">laikaExtensions</span><span> += </span><span class="identifier">laikaSpanRewriteRule</span><span> { 
  </span><span class="keyword">case</span><span> </span><span class="type-name">Emphasized</span><span>(</span><span class="identifier">content</span><span>, </span><span class="identifier">opts</span><span>) =&gt; </span><span class="type-name">Replace</span><span>(</span><span class="type-name">Strong</span><span>(</span><span class="identifier">content</span><span>, </span><span class="identifier">opts</span><span>))
}</span></code></pre>
        <p>For more details see the chapter <a href="../customizing-laika/tree-rewriting.html#document-tree-rewriting">Document Tree Rewriting</a>.</p>
        
        <h3 id="custom-document-type-matcher" class="section">Custom Document Type Matcher</h3>
        <p>A document type matcher categorizes an input document based on its path. 
        It is a function that takes a <code>Path</code> instance (from the Laika API, not <code>sbt.Path</code>)
        and returns the matching <code>DocumentType</code> with valid values being one of the following
        objects:</p>
        <pre><code class="nohighlight"><span class="type-name">Markup</span><span>, </span><span class="type-name">Template</span><span>, </span><span class="type-name">Dynamic</span><span>, </span><span class="type-name">Static</span><span>, </span><span class="type-name">Config</span><span>, </span><span class="type-name">Ignored</span></code></pre>
        <p>These values correspond to the descriptions provided in <a href="structure.html#document-types">Document Types</a>.</p>
        <p>The function is of type <code>Path =&gt; DocumentType</code> and can be added to the <code>laikaExtensions</code> setting:</p>
        <pre><code class="nohighlight"><span class="identifier">laikaExtensions</span><span> += </span><span class="identifier">laikaDocTypeMatcher</span><span> {
  </span><span class="keyword">case</span><span> </span><span class="identifier">path</span><span>: </span><span class="type-name">Path</span><span> =&gt; </span><span class="identifier">path</span><span>.</span><span class="identifier">name</span><span> </span><span class="keyword">match</span><span> {
    </span><span class="keyword">case</span><span> </span><span class="string-literal">&quot;hello.md&quot;</span><span> =&gt; </span><span class="type-name">Markup</span><span>
    </span><span class="keyword">case</span><span> </span><span class="string-literal">&quot;hello.js&quot;</span><span> =&gt; </span><span class="type-name">Static</span><span>
  }
}</span></code></pre>
        
        <h2 id="settings-for-directives" class="section">Settings for Directives</h2>
        <p>Directives are Laika&#39;s extension hook for both, templates and text markup.
        They allow to add new tag-like constructs without touching the existing parsers.</p>
        <p>Laika supports two flavors of directives, one compatible with the reStructuredText
        specification and the other with a Laika-specific syntax. </p>
        <p>The reStructuredText
        variant is supported for full compatibility with the reStructuredText specification
        and reuse of existing reStructuredText files making use of some of the standard
        directives. Laika supports almost all of the directives defined in the
        specification. Add an instance of type <code>RstExtensionRegistry</code> to the <code>laikaExtensions</code> 
        setting for adding custom implementations to the built-in ones.
        For more details on this directive type see <a href="../extending-laika/extending-rst.html#extending-restructuredtext">Extending reStructuredText</a>.</p>
        <p>The Laika variant is more flexible, as it can be used in template files as well
        as Markdown and reStructuredText markup. It is also somewhat simpler in syntax
        and configuration while offering the same functionality. It comes with a small
        set of predefined directives in this syntax. Add an instance of type <code>DirectiveRegistry</code> 
        to the <code>laikaExtensions</code> setting for adding custom implementations to the built-in ones.
        For more details on this directive type see <a href="../extending-laika/directive.html#directives">Directives</a>.</p>
        <p>The examples in the two chapters linked above show how to implement a directive
        and register it either for use in sbt or in embedded mode.</p>
        
        <h2 id="using-laika-for-github-pages" class="section">Using Laika for GitHub Pages</h2>
        <p>If you want to generate the site and push it up to the gh-pages branch of your GitHub repository
        in one go, you can combine Laika and the sbt-ghpages plugin.</p>
        <p>Add the sbt-ghpages plugin to <code>project/plugins.sbt</code>:</p>
        <pre><code class="nohighlight"><span class="identifier">resolvers</span><span> += </span><span class="string-literal">&quot;jgit-repo&quot;</span><span> </span><span class="identifier">at</span><span> </span><span class="string-literal">&quot;http://download.eclipse.org/jgit/maven&quot;</span><span>

</span><span class="identifier">addSbtPlugin</span><span>(</span><span class="string-literal">&quot;com.typesafe.sbt&quot;</span><span> % </span><span class="string-literal">&quot;sbt-ghpages&quot;</span><span> % </span><span class="string-literal">&quot;0.5.2&quot;</span><span>)</span></code></pre>
        <p>Configure the plugins in <code>build.sbt</code>:</p>
        <pre><code class="nohighlight"><span class="identifier">enablePlugins</span><span>(</span><span class="type-name">LaikaPluging</span><span>, </span><span class="type-name">GhpagesPlugin</span><span>)

</span><span class="identifier">git</span><span>.</span><span class="identifier">remoteRepo</span><span> := </span><span class="string-literal">&quot;git@github.com:{your username}/{your project}.git&quot;</span><span>

</span><span class="identifier">git</span><span>.</span><span class="identifier">gitCurrentBranch</span><span> := </span><span class="string-literal">&quot;master&quot;</span><span>

</span><span class="identifier">mappings</span><span> </span><span class="identifier">in</span><span> </span><span class="identifier">synchLocal</span><span> := (</span><span class="identifier">mappings</span><span> </span><span class="identifier">in</span><span> </span><span class="identifier">laikaSite</span><span>).</span><span class="identifier">value</span></code></pre>
        <p>It is the last line that connects the two plugins, but there is no need
        to understand how that line works.</p>
        <p>Finally run the task <code>ghpages-push-site</code>. This will also trigger the 
        Laika transformation if the site output is not up-to-date.</p>      

      </div>
    </div>

  </div>

</body></html>
